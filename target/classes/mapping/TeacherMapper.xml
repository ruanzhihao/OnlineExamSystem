<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.onlineExam.mapper.TeacherMapper">
    <select id="getAllTeacher" resultType="com.onlineExam.domain.Teacher">
        select * from teacher,major,depart,state where teacher.majorId=major.majorId and teacher.departId=depart.departId and teacher.stateId=state.stateId
    </select>
    <!--添加教师信息-->
    <insert id="addTeacher" parameterType="com.onlineExam.domain.Teacher" keyProperty="teacherid" useGeneratedKeys="true">
        insert into teacher(username,teachername,teacherpassword,teacherphoneNumber,teacheremail,majorId,departId,stateId)
        values (#{username},#{teachername},#{teacherpassword},#{teacherphoneNumber},#{teacheremail},#{majorId},#{departId},#{stateId})
    </insert>
    <!--通过id删除学生信息-->
    <delete id="deleteTeacher" parameterType="Integer">
        delete  from teacher where teacherid=#{teacherid}
    </delete>
    <select id="findTeacherById" parameterType="Integer" resultType="com.onlineExam.domain.Teacher">
        select * from teacher where teacherid=#{teacherid}
    </select>
    <!--修改教师信息-->
    <update id="updateTeacher" parameterType="com.onlineExam.domain.Teacher">
        update teacher
        <set>
            <if test="username!=null and username!=''">
                username=#{username},
            </if>
            <if test="teachername!=null and teachername!=''">
                teachername=#{teachername},
            </if>
            <if test="teacherpassword!=null and teacherpassword!=''">
                teacherpassword=#{teacherpassword},
            </if>
            <if test="teacherphoneNumber!=null and teacherphoneNumber!=''">
                teacherphoneNumber=#{teacherphoneNumber},
            </if>
            <if test="teacheremail!=null and teacheremail!=''">
                teacheremail=#{teacheremail},
            </if>
            <if test="majorId!=null and majorId!=0">
                majorId=#{majorId},
            </if>
            <if test="departId!=null and departId!=0">
                departId=#{departId},
            </if>
            <if test="stateId!=null and stateId!=0">
                stateId=#{stateId}
            </if>

        </set>
        where teacherid=#{teacherid}
    </update>
    <select id="queryTeacher" resultType="com.onlineExam.domain.Teacher">
        select * from teacher,major,depart,state where teachername=#{teachername} and teacher.majorId=major.majorId and teacher.departId=depart.departId and teacher.stateId=state.stateId
    </select>
    <!--登录-->
    <select id="login"   parameterType="String" resultType="String" >
    select roles from t_login where username = #{username} and password=#{password}
  </select>
    <!--	验证注册用户名是否存在 -->
    <select id="findRegisterUsername"   parameterType="String" resultType="com.onlineExam.domain.LoginUser" >
    select username  from t_login where username = #{value}
  </select>
    <!-- 添加用户账号 -->
    <insert id="register" parameterType="com.onlineExam.domain.LoginUser">
		INSERT INTO t_login(username,password,roles)
			VALUES(#{username},#{password},#{roles})
	</insert>
    <!-- 添加用户账号信息 -->
    <insert id="addTeacherInfo" parameterType="com.onlineExam.domain.Teacher">
		INSERT INTO teacher(username,teachername,teacherpassword,teacherphoneNumber,teacheremail)
		VALUES(#{username},#{teachername},#{teacherpassword},#{seteacherphoneNumberx},#{teacheremail})
	</insert>
</mapper>